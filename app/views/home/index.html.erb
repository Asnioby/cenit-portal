<div id="hero">
  <div id="cover-image" class="animated fadeIn">
    <div class="container">
      <h1 class="hero-text animated fadeIn">Data Integrator and Online Business Management</h1>
      <div class="cta animated fadeIn">
        <% if current_user.present? %>
         <% if app = Doorkeeper::Application.find_by(name: 'Cenit') %>
           <% options = { client_id: app.uid, redirect_uri: app.redirect_uri.split.first, response_type: 'code'} %>
           <%= link_to "Data Integrator",generate_url("/oauth/authorize", options), class: 'button' %>
         <% end %>
         <%= link_to "ERP & CRM", open_workspace(current_user), class: 'button' %>
         <%= link_to "Sign out", destroy_user_session_path, class: 'demo' %>
        <% else %>
          <a href='#sing_up', class='button sing_up_top'>Data Integrator</a>
          <a href='#sing_up', class='button sing_up_top'>ERP & CRM</a>
          <a id='sing_in_top' href='#sing_in' class="demo">Sign in</a>
        <% end %>
      </div>
      <div class="screenshot animated fadeInUp">
        <%= image_tag 'ss2.png',:class => 'img-responsive', :alt => 'screenshot' %>
      </div>
    </div>
  </div>
</div>

<%= render 'shared/features' %>
<%= render 'shared/splitter' %>
<%= render 'shared/services' %>
<%= render 'shared/splitter' %>
<%= render 'shared/odoo' %>
<%= render 'shared/prices' %>

<div id="cta">
<br><br><br>
<% unless current_user.present? %>
  <% resource ||= User.new %>

  <div id="sing_in_form" style='display:none;'>
    <div class="container text-center">
      <div class="row">
        <div class="col-md-12">
          <div class="form-wrapper" >
            <h4>Enter in your account now or <a id='sing_up_button' href='#sing_up' class="demo">sign up</a></h4>
            <% flash.each do |key, message| %>
              <div class="notice"><%= message %></div>
            <% end %>
            <%= form_for resource, as: :user, url: session_path(:user), remote: true, html:  { role: 'form', class: 'form-inline'} do |f| %>
              <div class="form-group">
                <%= f.email_field :email, class: 'form-control', :placeholder => 'Email' %>
              </div>
              <div class="form-group">
                <%= f.password_field :password, class: 'form-control', :placeholder => 'Password' %>
              </div>

              <%= f.submit 'Submit',:class => 'button button-small' %>
              <a name='sing_in'></a>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="sing_up_form">
    <div class="container text-center" >
      <div class="row">
        <div class="col-md-12">
          <div class="form-wrapper" >
            <h4>Ready to start? Create your free account now or <a id='sing_in_button' href='#sing_in' class="demo">sign in</a></h4>
            <% flash.each do |key, message| %>
              <div class="notice"><%= message %></div>
            <% end %>
  
            <%= form_for resource, as: :user, url: registration_path(:user), remote: true, html: { role: 'form', class: 'form-inline'} do |f| %>
              <div class="form-group">
                <%= f.email_field :email, class: 'form-control', placeholder: 'Email' %>
              </div>
              <div class="form-group">
                <%= f.password_field :password, class: 'form-control', placeholder: 'Password' %>
              </div>
              <div class="form-group">
                <%= f.password_field :password_confirmation, class: 'form-control', placeholder: 'Password Confirmation' %>
              </div>

              <%= f.submit 'Submit',:class => 'button button-small' %>
              <a name='sing_up'></a>
              
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>


<% end %>
</div>

<script>
    $(function () {
      
      $("#sing_in_button").click(function (e) {
         $("#sing_in_form").show();
         $("#sing_up_form").hide();
      });
      
      $("#sing_in_top").click(function (e) {
         $("#sing_in_form").show();
         $("#sing_up_form").hide();
      });
      
      $("#sing_up_button").click(function (e) {
         $("#sing_in_form").hide();
         $("#sing_up_form").show();
      });
      
      $(".sing_up_top").click(function (e) {
         $("#sing_in_form").hide();
         $("#sing_up_form").show();
      });

        // triggers the off-canvas panel
        $(".sidebar-toggle").click(function (e) {
            e.stopPropagation();
            $(".st-container").toggleClass("nav-effect");
        });
        $(".st-pusher").click(function () {
            $(".st-container").removeClass("nav-effect");
        });

        // parallax header
        $('#cover-image').css("background-position", "50% 50%");
        $(window).scroll(function() {
            var scroll = $(window).scrollTop(),
                    slowScroll = scroll/4,
                    slowBg = 50 - slowScroll;

            $('#cover-image').css("background-position", "50% " + slowBg + "%");
        
        });
        
        $('#exampleModal').on('show.bs.modal', function (event) {
          var button = $(event.relatedTarget); // Button that triggered the modal
          var recipient = button.data('whatever'); // Extract info from data-* attributes
          // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
          // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
          var modal = $(this);
          modal.find('.modal-title').text('New message to ' + recipient);
          modal.find('.modal-body input').val(recipient);
        });
        
        
    });
</script>
